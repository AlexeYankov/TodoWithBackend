{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { setAppStatusAC } from \"../../app/appReducer\";\nimport { handleServerNetworkError } from \"../../utils/error-utils\";\nimport todosApi from \"../../api/todosApi\";\nconst initialState = [];\nexport const getTodos = createAsyncThunk(\"todos/get\", async (args, thunkAPI) => {\n  thunkAPI.dispatch(setAppStatusAC({\n    status: \"loading\"\n  }));\n  try {\n    return await todosApi.getTodos().then(res => {\n      let todos = res.data;\n      console.log(todos);\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"succeeded\"\n      }));\n      return {\n        todos\n      };\n    }).catch(error => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"failed\"\n      }));\n      handleServerNetworkError(error, thunkAPI.dispatch);\n      const todos = [];\n      return {\n        todos\n      };\n    });\n  } catch (e) {\n    const err = e;\n    handleServerNetworkError(err, thunkAPI.dispatch);\n    thunkAPI.dispatch(setAppStatusAC({\n      status: \"failed\"\n    }));\n    const todos = [];\n    return {\n      todos\n    };\n  }\n});\nexport const createTodo = createAsyncThunk(\"todos/create\", async (data, thunkAPI) => {\n  thunkAPI.dispatch(setAppStatusAC({\n    status: \"loading\"\n  }));\n  try {\n    return await todosApi.createTodo(data).then(res => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"succeeded\"\n      }));\n      thunkAPI.dispatch(getTodos());\n      return \"\";\n    }).catch(error => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"failed\"\n      }));\n      handleServerNetworkError(error, thunkAPI.dispatch);\n      return \"\";\n    });\n  } catch (e) {\n    const err = e;\n    handleServerNetworkError(err, thunkAPI.dispatch);\n    thunkAPI.dispatch(setAppStatusAC({\n      status: \"failed\"\n    }));\n    return \"\";\n  }\n});\nexport const deleteTodo = createAsyncThunk(\"todos/delete\", async (id, thunkAPI) => {\n  thunkAPI.dispatch(setAppStatusAC({\n    status: \"loading\"\n  }));\n  try {\n    return await todosApi.deleteTodo(id).then(res => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"succeeded\"\n      }));\n      thunkAPI.dispatch(getTodos());\n      return \"\";\n    }).catch(error => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"failed\"\n      }));\n      handleServerNetworkError(error, thunkAPI.dispatch);\n      return \"\";\n    });\n  } catch (e) {\n    const err = e;\n    handleServerNetworkError(err, thunkAPI.dispatch);\n    thunkAPI.dispatch(setAppStatusAC({\n      status: \"failed\"\n    }));\n    return \"\";\n  }\n});\nexport const updateTodo = createAsyncThunk(\"todos/update\", async (params, thunkAPI) => {\n  thunkAPI.dispatch(setAppStatusAC({\n    status: \"loading\"\n  }));\n  try {\n    return await todosApi.updateTodo(params).then(res => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"succeeded\"\n      }));\n      thunkAPI.dispatch(getTodos());\n      return \"\";\n    }).catch(error => {\n      thunkAPI.dispatch(setAppStatusAC({\n        status: \"failed\"\n      }));\n      handleServerNetworkError(error, thunkAPI.dispatch);\n      return \"\";\n    });\n  } catch (e) {\n    const err = e;\n    handleServerNetworkError(err, thunkAPI.dispatch);\n    thunkAPI.dispatch(setAppStatusAC({\n      status: \"failed\"\n    }));\n    return \"\";\n  }\n});\nconst slice = createSlice({\n  name: \"todos\",\n  initialState: initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(getTodos.fulfilled, (state, action) => {\n      return state = action.payload.todos;\n    }).addCase(createTodo.fulfilled, (state, action) => {}).addCase(deleteTodo.fulfilled, (state, action) => {}).addCase(updateTodo.fulfilled, (state, action) => {});\n  }\n});\nexport const todosReducer = slice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","setAppStatusAC","handleServerNetworkError","todosApi","initialState","getTodos","args","thunkAPI","dispatch","status","then","res","todos","data","console","log","catch","error","e","err","createTodo","deleteTodo","id","updateTodo","params","slice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","payload","todosReducer","reducer"],"sources":["/home/alex/code/TodoWithBackend/front/src/features/todos/todosReducer.ts"],"sourcesContent":["import {PayloadAction, createAsyncThunk, createSlice} from \"@reduxjs/toolkit\";\r\nimport {setAppStatusAC} from \"../../app/appReducer\";\r\nimport {handleServerNetworkError} from \"../../utils/error-utils\";\r\nimport todosApi from \"../../api/todosApi\";\r\nimport {CreateTodoType, TodoType} from \"../../api/apiTypes\";\r\nimport {AxiosError} from \"axios\";\r\n\r\nconst initialState: TodoType[] = [];\r\n\r\nexport const getTodos = createAsyncThunk(\"todos/get\", async (args, thunkAPI) => {\r\n    thunkAPI.dispatch(setAppStatusAC({status: \"loading\"}));\r\n    try {\r\n        return await todosApi\r\n            .getTodos()\r\n            .then((res) => {\r\n                let todos = res.data;\r\n                console.log(todos);\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"succeeded\"}));\r\n\r\n                return {todos};\r\n            })\r\n            .catch((error) => {\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n                handleServerNetworkError(error, thunkAPI.dispatch);\r\n                const todos = [] as TodoType[];\r\n                return {todos};\r\n            });\r\n    } catch (e) {\r\n        const err = e as Error | AxiosError<{error: string}>;\r\n        handleServerNetworkError(err, thunkAPI.dispatch);\r\n        thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n        const todos = [] as TodoType[];\r\n        return {todos};\r\n    }\r\n});\r\n\r\nexport const createTodo = createAsyncThunk(\"todos/create\", async (data: CreateTodoType, thunkAPI) => {\r\n    thunkAPI.dispatch(setAppStatusAC({status: \"loading\"}));\r\n    try {\r\n        return await todosApi\r\n            .createTodo(data)\r\n            .then((res) => {\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"succeeded\"}));\r\n                thunkAPI.dispatch(getTodos());\r\n                return \"\";\r\n            })\r\n            .catch((error) => {\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n                handleServerNetworkError(error, thunkAPI.dispatch);\r\n                return \"\";\r\n            });\r\n    } catch (e) {\r\n        const err = e as Error | AxiosError<{error: string}>;\r\n        handleServerNetworkError(err, thunkAPI.dispatch);\r\n        thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n        return \"\";\r\n    }\r\n});\r\n\r\nexport const deleteTodo = createAsyncThunk(\"todos/delete\", async (id: string, thunkAPI) => {\r\n    thunkAPI.dispatch(setAppStatusAC({status: \"loading\"}));\r\n    try {\r\n        return await todosApi\r\n            .deleteTodo(id)\r\n            .then((res) => {\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"succeeded\"}));\r\n                thunkAPI.dispatch(getTodos());\r\n                return \"\";\r\n            })\r\n            .catch((error) => {\r\n                thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n                handleServerNetworkError(error, thunkAPI.dispatch);\r\n                return \"\";\r\n            });\r\n    } catch (e) {\r\n        const err = e as Error | AxiosError<{error: string}>;\r\n        handleServerNetworkError(err, thunkAPI.dispatch);\r\n        thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n        return \"\";\r\n    }\r\n});\r\n\r\nexport const updateTodo = createAsyncThunk(\r\n    \"todos/update\",\r\n    async (params: {id: string; data: CreateTodoType}, thunkAPI) => {\r\n        thunkAPI.dispatch(setAppStatusAC({status: \"loading\"}));\r\n        try {\r\n            return await todosApi\r\n                .updateTodo(params)\r\n                .then((res) => {\r\n                    thunkAPI.dispatch(setAppStatusAC({status: \"succeeded\"}));\r\n                    thunkAPI.dispatch(getTodos());\r\n                    return \"\";\r\n                })\r\n                .catch((error) => {\r\n                    thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n                    handleServerNetworkError(error, thunkAPI.dispatch);\r\n                    return \"\";\r\n                });\r\n        } catch (e) {\r\n            const err = e as Error | AxiosError<{error: string}>;\r\n            handleServerNetworkError(err, thunkAPI.dispatch);\r\n            thunkAPI.dispatch(setAppStatusAC({status: \"failed\"}));\r\n            return \"\";\r\n        }\r\n    }\r\n);\r\n\r\nconst slice = createSlice({\r\n    name: \"todos\",\r\n    initialState: initialState,\r\n    reducers: {},\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(getTodos.fulfilled, (state, action) => {\r\n                return (state = action.payload.todos);\r\n            })\r\n            .addCase(createTodo.fulfilled, (state, action) => {})\r\n            .addCase(deleteTodo.fulfilled, (state, action) => {})\r\n            .addCase(updateTodo.fulfilled, (state, action) => {});\r\n    },\r\n});\r\n\r\nexport const todosReducer = slice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}